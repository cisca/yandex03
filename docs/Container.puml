@startuml
title Тёплый дом Component Diagram

top to bottom direction

!includeurl https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/master/C4_Component.puml

Person(user, "User", "Пользователь системы Теплый дом")
Person(admin, "Administrator", "Команда по обслуживанию клиентов")

Container_Boundary(system, "") {
    Container(frontend, "Интерфейсы пользователей", "")
    Container(backend, "Архитектура приложения", "")
}

Container_Boundary(frontend, "") {
    Container(web, "Web Interface", "Панель администратора и оператора системы")
    Container(app, "Application", "Управление через приложение")
}

Container_Boundary(backend, "Архитектура приложения") {
    Container(gateway, "Api Gateway", "")
    Container(kafka, "Kafka", "Message broker")
    Container(users, "Пользователи системы", "Информация о пользователях и домах")
    Container(auth, "Сервис авторизации", "Контроль аутентификации и авторизации")
    Container(sensors, "Сервис датчиков", "Датчики и описание их возможной функциональности")
    Container(payments, "Сервис оплат", "Счета и оплата услуг")
    Container(personal, "Сервис персональных настроек", "Регистрация конкретных датчиков и их настроек с привязкой к дому")
    Container(report, "Сервис логирования и отчетов", "Мониторинг системы, отчеты и контроль сбоев")
    Container(notification, "Сервис уведомлений", "Уведомления пользователям и операторам")
    ContainerDb(users_db, "Users & Houses")
    ContainerDb(auth_db, "ACL & Sessions")
    ContainerDb(sensors_db, "Sensors & Functionality")
    ContainerDb(payments_db, "Bills & Payments")
    ContainerDb(personal_db, "Particular sensors & personal settings")
    ContainerDb(report_db, "Reports")
    ContainerDb(notification_db, "Notifications")
}

System_Ext(sensor, "Датчики температуры", "Отправляют информацию в систему")
System_Ext(heater, "Центральный контроллер системы обогрева", "Поднимает или понижает температуру в конкретном доме")
System_Ext(paymentSystem, "Платежная система", "Эквайринг для оплаты счетов")

Rel(gateway,users,"")
Rel(gateway,auth,"")
Rel(gateway,sensors,"")
Rel(gateway,personal,"")
Rel(gateway,payments,"")
Rel(gateway,report,"")
Rel(gateway,notification,"")


Rel(kafka,users,"")
Rel(kafka,auth,"")
Rel(kafka,sensors,"")
Rel(kafka,personal,"")
Rel(kafka,payments,"")
Rel(kafka,report,"")
Rel(kafka,notification,"")
Rel(sensor,gateway,"")
Rel(heater,gateway,"")
Rel(paymentSystem,gateway,"")

Rel(users,users_db,"")
Rel(auth,auth_db,"")
Rel(sensors,sensors_db,"")
Rel(personal,personal_db,"")
Rel(payments,payments_db,"")
Rel(report,report_db,"")
Rel(notification,notification_db,"")
Rel(user, app, "")
Rel(admin, web, "")
Rel(web,gateway,"")
Rel(app,gateway,"")
@enduml
